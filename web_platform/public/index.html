<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CW Studio - Real-time Morse Code Practice</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>üìª CW Studio</h1>
            <p class="tagline">Real-time Morse code practice with operators worldwide</p>
        </div>
    </header>

    <main class="container">
        <!-- Quick Join Section -->
        <section class="quick-join">
            <h2>Join a Practice Room</h2>
            <div class="room-form">
                <input type="text" id="callsign" placeholder="Your Callsign (e.g., SM0ONR)" maxlength="10" required>
                <input type="text" id="roomName" placeholder="Room name (optional, default: main)" value="main">
                <button id="joinButton" class="btn-primary">Join Room</button>
            </div>
            <p class="hint">üí° First time? Try the "main" room to meet other operators</p>
        </section>

        <!-- Schedule Section -->
        <section class="schedule">
            <h2>üìÖ Regular Schedule (UTC)</h2>
            <div class="sked-grid">
                <div class="sked-card">
                    <div class="day">Monday</div>
                    <div class="time">20:00 UTC</div>
                    <div class="speed">Slow Speed Net</div>
                    <div class="detail">12-18 WPM ‚Ä¢ Beginners welcome</div>
                </div>
                <div class="sked-card">
                    <div class="day">Wednesday</div>
                    <div class="time">20:00 UTC</div>
                    <div class="speed">Medium Speed Net</div>
                    <div class="detail">20-25 WPM ‚Ä¢ Intermediate</div>
                </div>
                <div class="sked-card">
                    <div class="day">Friday</div>
                    <div class="time">19:00 UTC</div>
                    <div class="speed">High Speed Net</div>
                    <div class="detail">25-35 WPM ‚Ä¢ Advanced</div>
                </div>
                <div class="sked-card">
                    <div class="day">Sunday</div>
                    <div class="time">14:00 UTC</div>
                    <div class="speed">Casual Ragchew</div>
                    <div class="detail">Any speed ‚Ä¢ Just for fun</div>
                </div>
            </div>
            <p class="current-time">Current time: <span id="utcTime">--:--:-- UTC</span></p>
        </section>

        <!-- How It Works -->
        <section class="how-it-works">
            <h2>üîß How It Works</h2>
            <div class="steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3>Connect</h3>
                    <p>Enter your callsign and join a room - microphone access required</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h3>Key CW</h3>
                    <p>Send Morse via audio input from your keyer or paddle</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3>Hear & Decode</h3>
                    <p>Real-time audio + automatic text decoding from all operators</p>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <h3>Practice Together</h3>
                    <p>Improve your CW skills with operators worldwide</p>
                </div>
            </div>
        </section>

        <!-- Features -->
        <section class="features">
            <h2>‚ú® Features</h2>
            <div class="feature-grid">
                <div class="feature">
                    <div class="icon">‚ö°</div>
                    <h3>Low Latency</h3>
                    <p>WebSocket relay delivers 370-400ms total latency - feels like HF radio</p>
                </div>
                <div class="feature">
                    <div class="icon">üéØ</div>
                    <h3>Adaptive Decoding</h3>
                    <p>Smart decoder adapts to your speed (12-35 WPM) automatically</p>
                </div>
                <div class="feature">
                    <div class="icon">üÜì</div>
                    <h3>Zero Cost</h3>
                    <p>Free forever. No registration, no ads, no tracking</p>
                </div>
                <div class="feature">
                    <div class="icon">üåç</div>
                    <h3>Worldwide Practice</h3>
                    <p>Connect with CW operators from any continent, any time</p>
                </div>
                <div class="feature">
                    <div class="icon">üì±</div>
                    <h3>Cross-Platform</h3>
                    <p>Browser-based - works on desktop, tablet, mobile</p>
                </div>
                <div class="feature">
                    <div class="icon">üîí</div>
                    <h3>Secure Transport</h3>
                    <p>WSS (WebSocket Secure) with TLS encryption for all data</p>
                </div>
            </div>
        </section>

        <!-- Setup for Native Clients -->
        <section class="native-setup">
            <h2>üîå Using Real CW Gear?</h2>
            <p>Connect your USB paddle, iambic keyer, or straight key with our native Python client:</p>
            <div class="code-block">
                <pre><code># Install dependencies
pip3 install pyaudio numpy pyserial

# Run the sender (auto-detects your keying style)
python3 cw_usb_key_sender.py main iambic-b 25 /dev/ttyUSB0

# The client handles:
# - Iambic A/B keying logic
# - Adaptive timing (12-35 WPM)
# - Audio sidetone generation
# - Network buffering & jitter compensation</code></pre>
            </div>
            <p><a href="https://github.com/tompatulpan/duration-encoded-cw-protocol" target="_blank">üì¶ Download native client from GitHub</a></p>
        </section>

        <!-- Active Rooms -->
        <section class="active-rooms">
            <h2>üü¢ Active Rooms Now</h2>
            <div id="roomsList" class="rooms-list">
                <p class="loading">Loading active rooms...</p>
            </div>
        </section>

        <!-- Technical Details -->
        <section class="tech-specs">
            <h2>‚öôÔ∏è Technical Specs</h2>
            <div class="spec-grid">
                <div class="spec">
                    <h4>Audio Quality</h4>
                    <p>48kHz Web Audio API ‚Ä¢ Sine wave synthesis ‚Ä¢ <strong>5ms attack/release</strong></p>
                </div>
                <div class="spec">
                    <h4>Jitter Buffer</h4>
                    <p>100-500ms adjustable buffer ‚Ä¢ Smooths network variations</p>
                </div>
                <div class="spec">
                    <h4>Decoder Engine</h4>
                    <p>Exponential smoothing (70/30) ‚Ä¢ <strong>Auto-adapts 12-35 WPM</strong></p>
                </div>
                <div class="spec">
                    <h4>Network Protocol</h4>
                    <p>WebSocket relay ‚Ä¢ Duration-encoded CW events ‚Ä¢ Real-time broadcast</p>
                </div>
                <div class="spec">
                    <h4>Latency</h4>
                    <p>70-100ms network + 300ms buffer = 370-400ms total</p>
                </div>
                <div class="spec">
                    <h4>Scaling</h4>
                    <p>Unlimited operators per room ‚Ä¢ Cloudflare Durable Objects relay</p>
                </div>
            </div>
        </section>

        <!-- FAQ -->
        <section class="faq">
            <h2>‚ùì FAQ</h2>
            <details>
                <summary>What equipment do I need?</summary>
                <p>Just a modern web browser and microphone access. Key CW by routing audio from your electronic keyer into your microphone input. For the best experience, use our Python client with a USB paddle or straight key.</p>
            </details>
            <details>
                <summary>How does the adaptive decoder work?</summary>
                <p>The decoder uses exponential smoothing (70/30 ratio) to track dit duration from the shortest tones. It automatically adapts to speed changes (12-35 WPM) within 3-5 characters. Each browser decodes independently from raw timing events.</p>
            </details>
            <details>
                <summary>Why is there latency?</summary>
                <p>The adjustable jitter buffer (default 300ms) smooths network timing variations, ensuring clean CW without clicks. Total latency is 370-400ms (70-100ms network + 300ms buffer), comparable to HF propagation delays.</p>
            </details>
            <details>
                <summary>How does the network protocol work?</summary>
                <p>CW events (key down/up with durations) are sent via WebSocket to a Cloudflare Worker, which relays them to all room members. Each client's browser plays audio and decodes text locally from the timing information.</p>
            </details>
            <details>
                <summary>Can I use this for official QSOs?</summary>
                <p>This is a practice platform, not a licensed amateur radio service. Use it to improve your CW skills, then take those skills to the air!</p>
            </details>
            <details>
                <summary>Can I create private rooms?</summary>
                <p>Absolutely! Enter any unique room name when joining. Share the room name with your friends for private practice sessions.</p>
            </details>
            <details>
                <summary>Is this open source?</summary>
                <p>Yes! MIT licensed. Check out <a href="https://github.com/tompatulpan/duration-encoded-cw-protocol" target="_blank">the GitHub repository</a> for the full source code, protocol documentation, and technical deep-dives.</p>
            </details>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>Built with ‚ù§Ô∏è for the amateur radio community</p>
            <p>
                <a href="https://github.com/tompatulpan/duration-encoded-cw-protocol" target="_blank">GitHub</a> ‚Ä¢
                <a href="#" id="aboutLink">About</a> ‚Ä¢
                <a href="#" id="privacyLink">Privacy</a>
            </p>
            <p class="footer-73">73 de SM0ONR</p>
        </div>
    </footer>

    <script src="js/landing.js"></script>
</body>
</html>
