<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CW Studio - Practice Room</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="room-page">
    <header class="room-header">
        <div class="container">
            <h1>ðŸ“» CW Studio</h1>
            <div class="room-info">
                <span id="roomName">Room: --</span>
                <span id="callsignDisplay">Callsign: --</span>
                <span id="connectionStatus" class="status disconnected">Disconnected</span>
            </div>
        </div>
    </header>
    
    <!-- Audio Permission Banner -->
    <div id="audioPermissionBanner" class="audio-banner" style="display: none;">
        <div class="banner-content">
            <span>ðŸ”Š Click anywhere to enable audio</span>
            <button id="enableAudioBtn" class="btn-enable-audio">Enable Audio</button>
        </div>
    </div>

    <main class="room-container">
        <!-- Users Panel -->
        <aside class="users-panel">
            <h3>Active Operators</h3>
            <div id="usersList" class="users-list">
                <p>No other users yet</p>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Manual Keying -->
            <section class="keying-section">
                <h2>Manual Key</h2>
                <div class="key-controls">
                    <button id="ditButton" class="btn-key dit">
                        <span>Dit</span>
                        <small>(,)</small>
                    </button>
                    <button id="dahButton" class="btn-key dah">
                        <span>Dah</span>
                        <small>(.)</small>
                    </button>
                    <button id="straightKeyButton" class="btn-key straight">
                        <span>Straight Key</span>
                        <small>(Space)</small>
                    </button>
                </div>
                <div style="margin-top: 10px;">
                    <label>
                        <input type="checkbox" id="enableKeyboardShortcuts">
                        Enable keyboard shortcuts (, . Space)
                    </label>
                </div>
                <p class="help-text">Press , for dit, . for dah, Space for straight key</p>
            </section>

            <!-- Automated Sending -->
            <section class="send-section">
                <h2>Send Text</h2>
                <div class="send-controls">
                    <textarea id="textInput" placeholder="Enter text to send as Morse code..." rows="3"></textarea>
                    <div class="send-options">
                        <label>
                            Speed:
                            <input type="range" id="wpmSlider" min="10" max="40" value="20" step="1">
                            <span id="wpmValue">20</span> WPM
                        </label>
                        <label>
                            <input type="checkbox" id="autoSendText">
                            Auto-send as you type
                        </label>
                        <button id="sendButton" class="btn-primary">Send Text</button>
                    </div>
                </div>
            </section>

            <!-- Practice Drills -->
            <section class="drills-section">
                <h2>Practice Drills</h2>
                <div class="drills-grid">
                    <button class="btn-drill" id="randomLetters">Random Letters</button>
                    <button class="btn-drill" id="randomNumbers">Random Mixed</button>
                    <button class="btn-drill" data-text="ABCDEFGHIJ">A-J</button>
                    <button class="btn-drill" data-text="KLMNOPQRST">K-T</button>
                    <button class="btn-drill" data-text="UVWXYZ">U-Z</button>
                    <button class="btn-drill" data-text="0123456789">0-9</button>
                </div>
            </section>

            <!-- Decoder Output -->
            <section class="decoder-section">
                <h2>Decoded Text</h2>
                <div id="decoderOutput" class="decoder-output">
                    <!-- Decoded text will appear here -->
                </div>
            </section>
        </div>

        <!-- Statistics Panel -->
        <aside class="stats-panel">
            <h3>Statistics</h3>
            <div class="stats-grid">
                <div class="stat">
                    <span class="stat-label">Events Sent:</span>
                    <span id="statEventsSent" class="stat-value">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Events Received:</span>
                    <span id="statEventsReceived" class="stat-value">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Queue Depth:</span>
                    <span id="statQueueDepth" class="stat-value">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Buffer:</span>
                    <span id="statBuffer" class="stat-value">150ms</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Latency:</span>
                    <span id="statLatency" class="stat-value">--</span>
                </div>
            </div>
            
            <h3>Settings</h3>
            <div class="settings">
                <label>
                    <input type="checkbox" id="audioEnabled" checked>
                    Audio Enabled
                </label>
                <label>
                    <input type="checkbox" id="debugMode">
                    Debug Mode <span id="debugStatusIndicator" style="color: #666;">âœ—</span>
                </label>
                <small style="color: #666; display: block; margin-left: 20px; margin-top: -5px;">
                    Enable verbose console logging (increases CPU)
                </small>
                <label>
                    Sidetone Frequency:
                    <input type="range" id="sidetoneFreq" min="400" max="1000" value="700" step="50">
                    <span id="freqValue">700</span> Hz
                </label>
                <label>
                    Volume:
                    <input type="range" id="volumeSlider" min="0" max="100" value="30" step="5">
                    <span id="volumeValue">30</span>%
                </label>
                <label>
                    Buffer Size:
                    <input type="range" id="bufferSlider" min="50" max="300" value="150" step="10">
                    <span id="bufferValue">150</span> ms
                </label>
            </div>
        </aside>
    </main>

    <script src="js/jitter-buffer.js"></script>
    <script src="js/audio-handler.js"></script>
    <script src="js/cw-decoder.js"></script>
    <script src="js/tcp-ts-client.js"></script>
    <script src="js/room-controller.js"></script>
</body>
</html>
